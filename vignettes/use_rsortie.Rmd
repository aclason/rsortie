---
title: "Structure of rsortie"
output: rmarkdown::html_vignette
date: "January 2022"
vignette: >
  %\VignetteIndexEntry{Structure of rsortie}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

rsortie supports interacting with SORTIE-ND in an R environment.


## SORTIE-ND

SORTIE-ND (hereafter SORTIE) is an individual-based, spatially-explicit model of forest stand dynamics. Specifically:  

* SORTIE simulates the processes of establishment, growth and mortality of individuals, in resource-mediated (primarily light) interactions
* Trees are individuals with x-y coordinates that interact in neighbourhoods
* complex, spatial or aspatial silviculture experiments, including partial harvests and planting are built into in SORTIE
* SORTIE tracks trees in space and time, meaning any metric that can be applied to individuals or stands, can be calculated from SORTIE outputs. 

Here we break down some of these key components:

### SORTIE initiation
#### SORTIE parameter file
Opening the SORTIE GUI does not instantly produce a usable model. A valid SORTIE parameter file is required, which contains all of the functions, called "behaviours", that define how a forest should establish, grow and die. These behaviours or functions, describe the shape of a response or relationship between variables (logistic growth curve as a function of tree size). All the variables or "parameters" contained in the selected behaviours must be defined to make those functions work. So theoretically, you could construct a SORTIE parameter file based solely off literature produced parameters, as long as the functions are available in SORTIE. More often, over a series of years, and many publications, parameter files are built from a lot of field data that are used to parameterize SORTIE behaviours (functions). After initial parameterization, validation and model testing may require calibration of certain parameters to better reflect forest stand dynamics in the place of interest. To initiate a SORTIE simulation, you must then have a SORTIE parameter file, or build one and populate all the parameter values required for each of the behaviours. Please see www.sortie-nd.com for detailed model description, including recommended minimum stand sizes and definition of all behaviours contained in the model.

#### run starting conditions
With a valid SORTIE parameter file in hand, defining how a given forest should grow etc., the next step to initiation is to define the starting conditions for any one particular forest: run length, plot dimension, and starting forest composition. For initial stand conditions, SORTIE is most often initiated by a tree list: a table that contains the density (stems/ha) of each tree species in user-defined diameter classes. Alternatively, a stand can be initiated through a spatial tree map (stem map) of the exact starting location, identity and size (diameter) of trees.

### SORTIE outputs
There are many possible outputs from a SORTIE simulation. All the output options must be selected and applied to the parameter file, including where the output file location should be. There are two output options: detailed and summary, with different.


## rsortie

rsortie is designed to support a continuous workflow from data through to model outputs, making model development, parameterization, experimentation and validation efficient and reproducible (McIntire et al 2021 preprint). This takes advantage of packages already developed in R, including the ability to manipulate datasets and spatial files effectively, supporting larger and more complex experiments applied within SORTIE-ND. Examples and uses of rsortie are explored in other vignettes.

rsortie can be used in a continuous workflow (from data to outputs) or in stages. Often with complex silviculture prescriptions or experimental designs, there will still be a need to interact with SORTIE through the graphical user interface (GUI). Many modifications of the structure (behaviours) that define a SORTIE run must occur in the GUI before those variables (or parameters) are available to change in R.

A typical workflow in rsortie may include:

1. Importing initial stands (plots) and manipulating data to generate SORTIE starting conditions
2. Defining a base parameter file to update with initial stands
3. Modifying parameter values (i.e. stand initial conditions, time steps to run, or parameter values from a certain behaviour in a parameterization experiment), which always include updating the output file pathways in the base parameter file
4. Modify silviculture treatments (harvest, planting) defined in the base parameter file
5. Run the model for each parameter file of interest, either in serial or with parallel processing
6. Extract and parse model outputs
7. Analyze outputs

## get started
To use rsortie, first install and load the package:

```{r}
#install.packages("devtools")
library("devtools")
devtools::install_github("aclason/rsortie")

```





Literature Cited:
McIntire E, Chubaty A, Cumming S, et al. PERFICT: a Re-imagined Foundation for Predictive Ecology. Authorea Preprints; 2021. DOI: 10.22541/au.163252535.52485317/v1


